(window.webpackJsonpapp=window.webpackJsonpapp||[]).push([[0],{108:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(27),c=a.n(r),l=a(5),i=(a(46),a(15)),s=a(62),m=a.n(s),u=a(3),d=a(7),b=a.n(d),p=a(42),v=a(111),f=a(112),E=a(110),g=a(113),h=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)({}),l=Object(u.a)(c,2),i=(l[0],l[1]),s=function(e,t){console.log("handle map update",e,t),r(e),i(t)},m=Object(n.useState)("canvas"),d=Object(u.a)(m,2);d[0],d[1];return Object(n.useEffect)((function(){return window.socket.on(b.a.placeChange,s),function(){window.socket.removeListener(b.a.placeChange,s)}}),[]),o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("div",{id:"map",style:{width:720,height:720}},o.a.createElement(v.a,{center:[60,24],zoom:5,style:{width:720,height:720,marginTop:50}},o.a.createElement(f.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),a.map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];if(e)return console.log(22333,n),o.a.createElement(E.a,{position:[n.latitude,n.longitude],key:a},o.a.createElement(g.a,null,"user:",a,o.a.createElement("br",null),"latitude= ",n.latitude,o.a.createElement("br",null)," longitude=",n.longitude,"."))}))))))},w=function(e){var t,a=Object(n.useState)([]),r=Object(u.a)(a,2),c=r[0],i=r[1],s=Object(n.useState)({}),m=Object(u.a)(s,2),d=m[0],p=m[1],v=Object(n.useState)(void 0),f=Object(u.a)(v,2),E=f[0],g=f[1],h=null;e.isRoom?(console.log("is room"),t=e.room,h=window.room):(console.log("not room"),t="main",h=window.socket),Object(n.useEffect)((function(){h.emit("joinRoom",t),h.on("newU",(function(e){console.log(e)}));var e=setInterval((function(){h&&(g(h.id+t),clearInterval(e),console.log("set my status"))}),200)}));var w=function(e,t){console.log("handle user list update",t),i(e),p(t)};Object(n.useEffect)((function(){return h.emit("myRoom",t),h.emit(b.a.initQuery),h.on(b.a.activeMembers,w),function(){h.removeListener(b.a.activeMembers,w)}}),[]);var j=function(){h.emit("leave")};return o.a.createElement("div",null,E?o.a.createElement("div",{id:"my-status"},o.a.createElement("i",{className:"material-icons"},"account_circle"),o.a.createElement("span",{style:{color:d[E.substring(0,5)]}},E.substring(0,5))):"connecting...",o.a.createElement("div",{id:"user-list"},o.a.createElement("div",{className:"bold"},"Active users"),o.a.createElement("ul",{className:"clean-list"},c.map((function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("div",{className:"user-item",style:{background:d[e]}},e))})))),o.a.createElement("div",null,o.a.createElement("button",{className:"create-room-b",id:"create-room-b",onClick:j},o.a.createElement(l.b,{to:"/createroom",style:{textDecoration:"none",color:"inherit"}},"Create a private room")),o.a.createElement("button",{className:"create-room-b",id:"join-room-b",onClick:j},o.a.createElement(l.b,{to:"/auth",style:{textDecoration:"none",color:"inherit"}},"Join a private room"))))},j=function(e){var t=e.coords;if(t){var a=t.latitude,n=t.longitude;return o.a.createElement("div",{className:"coords-tab"},o.a.createElement("div",null,"latitude: ",a),o.a.createElement("div",null,"longitude: ",n))}return o.a.createElement("div",null,"Getting position...")},O=[{latitude:59.3293,longitude:18.0686,name:"Stockholm"},{latitude:59.9139,longitude:10.7522,name:"Oslo"},{latitude:40.4168,longitude:3.7038,name:"Madrid"},{latitude:52,longitude:13,name:"Berlin"},{latitude:55.7558,longitude:37.52,name:"Moscow"},{latitude:41.8902,longitude:12.4923,name:"Rome"},{latitude:48.8647,longitude:2.349,name:"Paris"},{latitude:47.4979,longitude:19.0402,name:"Budapest"},{latitude:52.3718,longitude:4.896,name:"Amsterdam"},{latitude:59.4369,longitude:24.7535,name:"Tallin"}],y=function(e){var t=e.setCoords,a=e.setAddress,n=function(e){var n=e.data;return o.a.createElement("div",Object.assign({className:"location-button"},n,{onClick:function(){t({latitude:n.latitude,longitude:n.longitude}),a(n.name),window.socket.emit(b.a.placeChange,n)}}),o.a.createElement("div",null,n.name),o.a.createElement("div",null,o.a.createElement("i",{className:"material-icons"},"airplanemode_active")))};return o.a.createElement("div",{className:"location-buttons-container"},O.map((function(e){return o.a.createElement(n,{data:e,key:e.name})})))},k=a(32),N=a.n(k),C=a(64),S=a(35),x=a.n(S);x.a.setApiKey("AIzaSyD_FDJ_tv1sCOg80r5m4M-lF3xhDvGE-ks"),x.a.enableDebug();var D=function(e){window.isSecureContext?"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(e):alert("not secure context")},R=function(){var e=function(){var e=Object(n.useState)(void 0),t=Object(u.a)(e,2),a=t[0],o=t[1],r=Object(n.useState)(""),c=Object(u.a)(r,2),l=c[0],i=c[1];return Object(n.useEffect)((function(){D(function(){var e=Object(C.a)(N.a.mark((function e(t){var a,n,r,c,l;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.coords,console.log(a,"uesGeo"),o(a),n=a.latitude,r=a.longitude,e.next=6,x.a.fromLatLng(n,r);case 6:c=e.sent,console.log(c),l="Current","OK"===c.status&&(l=c.results[0].formatted_address,i(l)),window.socket.emit(b.a.placeChange,{latitude:n,longitude:r,name:l});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),[a,o,l,i]}(),t=Object(u.a)(e,4),a=t[0],r=t[1],c=t[2],l=t[3],i=function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e}),[e]),t.current}(a),s=Object(n.useState)(!1),m=Object(u.a)(s,2),d=m[0],v=m[1];Object(n.useEffect)((function(){if(i){var e=[a,i].map((function(e){return[e.latitude,e.longitude]})).reduce((function(e,t){return Object(p.range)(t.length).map((function(a,n){e[n]-=t[n]})),e}));e.some((function(e){return e>.01}))&&console.log("change delta:",e)}}),[a,i]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"current-location"},o.a.createElement("div",{className:"location-button",onClick:function(){v(!0),D((function(e){var t=e.coords;r(t),l("Current"),console.log("updated position",t);var a=t.latitude,n=t.longitude;window.socket.emit(b.a.placeChange,{latitude:a,longitude:n,name:"Current"}),v(!1)}))}},o.a.createElement("div",null,"Current ")," ",o.a.createElement("i",{className:"material-icons"},"near_me")),d?o.a.createElement("div",null,"Updating ..."):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"serif"},c),o.a.createElement(j,{coords:a})," ")),o.a.createElement((function(){return i?o.a.createElement("div",{id:"previous-location"},o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",null,"Previous ")," ",o.a.createElement("i",{className:"material-icons"},"history")),o.a.createElement(j,{coords:i})):o.a.createElement("div",null)}),null),o.a.createElement(y,{setCoords:r,setAddress:l}))},B=function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"fl w-40 pl5 mt5"},o.a.createElement(w,{isRoom:!1}),o.a.createElement(R,null)),o.a.createElement("div",{className:"fr w-40 pa1 mt4"},o.a.createElement(h,null)))},M=a(33),A=a(18),J=a(19),_=a(21),F=a(20),I=a(22),L=function(e){function t(){var e,a;Object(A.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(_.a)(this,(e=Object(F.a)(t)).call.apply(e,[this].concat(o)))).state={name:"",password:"",onCall:""},a.handleChange=function(e){a.setState(Object(M.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.setState({onCall:a.state.name}),console.log(a.state)},a}return Object(I.a)(t,e),Object(J.a)(t,[{key:"goBack",value:function(e){e.preventDefault(),this.props.history.goBack()}},{key:"render",value:function(){var e=this;return console.log(this.state.name),this.state.onCall?o.a.createElement(i.a,{to:{pathname:"/rooms/".concat(this.state.onCall)}}):o.a.createElement("div",{className:"center"},o.a.createElement("div",null,o.a.createElement("button",{className:"pa2 b--black input-reset ba bg-transparent mt4",onClick:function(t){e.goBack(t)}},"Back"),o.a.createElement("form",{className:"center mt5"},o.a.createElement("div",{className:"input-field mt3  center"},o.a.createElement("label",{htmlFor:"password",className:"db fw4 lh-copy f6"},"Room Name",o.a.createElement("br",null)),o.a.createElement("input",{className:"pa2 input-reset ba bg-transparent w-100 measure",type:"name",id:"name",onChange:this.handleChange})),o.a.createElement("div",{className:"mt3 center"},o.a.createElement("button",{onClick:this.handleSubmit,type:"submit",defaultValue:"Create",className:"pa2 b--black input-reset ba bg-transparent"},"Create")))))}}]),t}(n.Component),P=function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),r=a[0],c=a[1],i=Object(n.useState)({}),s=Object(u.a)(i,2),m=s[0],d=s[1],p=Object(n.useState)(void 0),v=Object(u.a)(p,2),f=v[0],E=v[1],g=e.room,h=window.socket;Object(n.useEffect)((function(){h.emit("joinRoom",g),h.on("newU",(function(e){console.log(e)}));var e=setInterval((function(){h&&(E(h.id),clearInterval(e),console.log("set my status"))}),200)}));var w=function(e,t){console.log("handle user list update",t),c(e),d(t)};Object(n.useEffect)((function(){return h.emit("myRoom",g),h.emit(b.a.initQuery),h.on(b.a.activeMembers,w),function(){h.removeListener(b.a.activeMembers,w)}}),[]);var j=function(){h.emit("leave")};return o.a.createElement("div",null,f?o.a.createElement("div",{id:"my-status"},o.a.createElement("i",{className:"material-icons"},"account_circle"),o.a.createElement("span",{style:{color:m[f.substring(0,5)]}},f.substring(0,5)+" in room (".concat(g,")"))):"connecting...",o.a.createElement("div",{id:"user-list"},o.a.createElement("div",{className:"bold"},"Active users"),o.a.createElement("ul",{className:"clean-list"},r.map((function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("div",{className:"user-item",style:{background:m[e]}},e))})))),o.a.createElement("div",null,o.a.createElement("button",{className:"create-room-b",id:"create-room-b",onClick:j},o.a.createElement(l.b,{to:"/createroom",style:{textDecoration:"none",color:"inherit"}},"Create a private room")),o.a.createElement("button",{className:"create-room-b",id:"join-room-b",onClick:j},o.a.createElement(l.b,{to:"/auth",style:{textDecoration:"none",color:"inherit"}},"Join a private room"))))},Q=function(e){function t(e){var a;return Object(A.a)(this,t),(a=Object(_.a)(this,Object(F.a)(t).call(this,e))).leaveRoom=function(){window.socket.emit("leave")},a.state={name:a.props.match.params.id},a}return Object(I.a)(t,e),Object(J.a)(t,[{key:"render",value:function(){return console.log(this.state.name),o.a.createElement("div",null,o.a.createElement("button",{onClick:this.leaveRoom,className:"pa2 b--black input-reset ba bg-transparent mt4s mt3 pl4"},o.a.createElement(l.b,{to:"/",style:{textDecoration:"none",color:"inherit"}},"Back To Main Page")),o.a.createElement("div",null,o.a.createElement("div",{className:"fl w-40 pl5 mt4"},o.a.createElement(P,{room:this.state.name}),o.a.createElement(R,null)),o.a.createElement("div",{className:"fr w-40 pa1 mt3"},o.a.createElement(h,null))))}}]),t}(n.Component),T=function(e){function t(){var e,a;Object(A.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(_.a)(this,(e=Object(F.a)(t)).call.apply(e,[this].concat(o)))).state={name:"",password:"",hash:""},a.handleChange=function(e){a.setState(Object(M.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.setState({hash:a.state.name}),console.log(a.state)},a}return Object(I.a)(t,e),Object(J.a)(t,[{key:"goBack",value:function(e){e.preventDefault(),this.props.history.goBack()}},{key:"render",value:function(){return console.log(this.state.name),this.state.hash?o.a.createElement(i.a,{to:"/rooms/".concat(this.state.hash)}):o.a.createElement("div",{className:"fl w-100 pa2"},o.a.createElement("button",{className:"pa2 b--black input-reset ba bg-transparent mt4s mt3 pl4"},o.a.createElement(l.b,{to:"/",style:{textDecoration:"none",color:"inherit"}},"Back To Main Page")),o.a.createElement("label",{className:"tc f1 fl w-100"},"Join A Room"),o.a.createElement("div",{className:" fl w-60 pl7 mt4 ma7"},o.a.createElement("form",{className:"center mt5"},o.a.createElement("div",{className:"input-field mt3  center"},o.a.createElement("label",{htmlFor:"password",className:"db fw4 lh-copy f6"},"Room Name",o.a.createElement("br",null)),o.a.createElement("input",{className:"pa2 input-reset ba bg-transparent w-100 measure",type:"name",id:"name",onChange:this.handleChange})),o.a.createElement("div",{className:"mt3 center"},o.a.createElement("button",{onClick:this.handleSubmit,type:"submit",defaultValue:"Create",className:"pa2 b--black input-reset ba bg-transparent"},o.a.createElement(l.b,{to:"/rooms/".concat(this.state.name),style:{textDecoration:"none",color:"inherit"}},"Join"))))))}}]),t}(n.Component),z=window.location.origin;window.socket=m()(z);var G=function(){return o.a.createElement("div",{className:"app"},o.a.createElement(i.b,{exact:!0,path:"/",component:B}),o.a.createElement(i.b,{path:"/createroom",component:L}),o.a.createElement(i.b,{path:"/rooms/:id",component:Q}),o.a.createElement(i.b,{path:"/auth",component:T}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(107);c.a.render(o.a.createElement(l.a,null,o.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},46:function(e,t,a){},65:function(e,t,a){e.exports=a(108)},7:function(e,t){e.exports={activeMembers:"activeMembers",initQuery:"initQuery",placeChange:"placeChange"}},98:function(e,t){}},[[65,1,2]]]);
//# sourceMappingURL=main.5df47bd4.chunk.js.map