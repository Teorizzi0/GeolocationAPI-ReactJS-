(window.webpackJsonpapp=window.webpackJsonpapp||[]).push([[0],{1:function(e,t){e.exports={activeMembers:"activeMembers",initQuery:"initQuery",placeChange:"placeChange"}},35:function(e,t,n){e.exports=n(74)},40:function(e,t,n){},69:function(e,t){},74:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(31),o=n.n(c),i=(n(40),n(32)),l=n.n(i),u=n(33),s=n(2),d=n(1),m=n.n(d),f=n(5);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var g=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)({}),i=Object(s.a)(o,2),l=i[0],d=i[1],g=Object(a.useRef)(),p=function(e,t){console.log("handle map update",e,t),c(e),d(t)};return Object(a.useEffect)((function(){window.socket.on(m.a.placeChange,p);var e=g.current.getContext("2d");return e.fillStyle="#BFBFBF",e.fillRect(0,0,720,720),function(){window.socket.removeListener(m.a.placeChange,p)}}),[]),Object(a.useEffect)((function(){var e=g.current.getContext("2d");e.fillStyle="#F2F2F2",e.fillRect(0,0,720,720),e.font="12px Inconsolata";var t=n.map((function(e){var t=e[0],n=e[1].name;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(f.chain)(e[1]).pick(["latitude","longitude"]).mapValues(Object(f.unary)(parseInt)).mapValues((function(e){return 720*e/90})).value(),{color:l[t],name:n})}));console.log(t),t.forEach((function(t){e.fillStyle=t.color,e.fillRect(t.longitude,720-t.latitude,10,10),e.fillText(t.name,t.longitude+15,720-t.latitude+5)}))}),[n]),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("canvas",{ref:g,id:"map",width:720,height:720})))},p=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)({}),i=Object(s.a)(o,2),l=i[0],u=i[1],d=Object(a.useState)(void 0),f=Object(s.a)(d,2),v=f[0],g=f[1];Object(a.useEffect)((function(){var e=setInterval((function(){var t=window.socket;t&&(g(t.id),clearInterval(e),console.log("set my status"))}),200)}));var p=function(e,t){console.log("handle user list update",t),c(e),u(t)};return Object(a.useEffect)((function(){return window.socket.emit(m.a.initQuery),window.socket.on(m.a.activeMembers,p),function(){window.socket.removeListener(m.a.activeMembers,p)}}),[]),r.a.createElement("div",null,v?r.a.createElement("div",{id:"my-status"},r.a.createElement("i",{className:"material-icons"},"account_circle"),r.a.createElement("span",{style:{color:l[v.substring(0,5)]}},v.substring(0,5))):"connecting...",r.a.createElement("div",{id:"user-list"},r.a.createElement("div",{className:"bold"},"Active users"),r.a.createElement("ul",{className:"clean-list"},n.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("div",{className:"user-item",style:{background:l[e]}},e))})))))},b=function(e){var t=e.coords;if(t){var n=t.latitude,a=t.longitude;return r.a.createElement("div",{className:"coords-tab"},r.a.createElement("div",null,"latitude: ",n),r.a.createElement("div",null,"longitude: ",a))}return r.a.createElement("div",null,"Getting position...")},E=[{latitude:59.3293,longitude:18.0686,name:"Stockholm"},{latitude:59.9139,longitude:10.7522,name:"Oslo"},{latitude:40.4168,longitude:3.7038,name:"Madrid"},{latitude:52,longitude:13,name:"Berlin"},{latitude:55.7558,longitude:37.52,name:"Moscow"},{latitude:41.8902,longitude:12.4923,name:"Rome"},{latitude:48.8647,longitude:2.349,name:"Paris"},{latitude:47.4979,longitude:19.0402,name:"Budapest"},{latitude:52.3718,longitude:4.896,name:"Amsterdam"},{latitude:59.4369,longitude:24.7535,name:"Tallin"}],O=function(e){var t=e.setCoords,n=e.setAddress,a=function(e){var a=e.data;return r.a.createElement("div",Object.assign({className:"location-button"},a,{onClick:function(){t({latitude:a.latitude,longitude:a.longitude}),n(a.name),window.socket.emit(m.a.placeChange,a)}}),r.a.createElement("div",null,a.name),r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons"},"airplanemode_active")))};return r.a.createElement("div",{className:"location-buttons-container"},E.map((function(e){return r.a.createElement(a,{data:e,key:e.name})})))},w=n(8),j=n.n(w),h=n(34),y=n(9),k=n.n(y);k.a.setApiKey("AIzaSyD_FDJ_tv1sCOg80r5m4M-lF3xhDvGE-ks"),k.a.enableDebug();var C=function(e){window.isSecureContext?"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(e):alert("not secure context")},S=function(){var e=function(){var e=Object(a.useState)(void 0),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),o=Object(s.a)(c,2),i=o[0],l=o[1];return Object(a.useEffect)((function(){C(function(){var e=Object(h.a)(j.a.mark((function e(t){var n,a,c,o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.coords,console.log(n,"uesGeo"),r(n),a=n.latitude,c=n.longitude,e.next=6,k.a.fromLatLng(a,c);case 6:o=e.sent,console.log(o),i="Current","OK"===o.status&&(i=o.results[0].formatted_address,l(i)),window.socket.emit(m.a.placeChange,{latitude:a,longitude:c,name:i});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),[n,r,i,l]}(),t=Object(s.a)(e,4),n=t[0],c=t[1],o=t[2],i=t[3],l=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e}),[e]),t.current}(n),u=Object(a.useState)(!1),d=Object(s.a)(u,2),v=d[0],g=d[1];Object(a.useEffect)((function(){if(l){var e=[n,l].map((function(e){return[e.latitude,e.longitude]})).reduce((function(e,t){return Object(f.range)(t.length).map((function(n,a){e[a]-=t[a]})),e}));e.some((function(e){return e>.01}))&&console.log("change delta:",e)}}),[n,l]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"current-location"},r.a.createElement("div",{className:"location-button",onClick:function(){g(!0),C((function(e){var t=e.coords;c(t),i("Current"),console.log("updated position",t);var n=t.latitude,a=t.longitude;window.socket.emit(m.a.placeChange,{latitude:n,longitude:a,name:"Current"}),g(!1)}))}},r.a.createElement("div",null,"Current ")," ",r.a.createElement("i",{className:"material-icons"},"near_me")),v?r.a.createElement("div",null,"Updating ..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"serif"},o),r.a.createElement(b,{coords:n})," ")),r.a.createElement((function(){return l?r.a.createElement("div",{id:"previous-location"},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,"Previous ")," ",r.a.createElement("i",{className:"material-icons"},"history")),r.a.createElement(b,{coords:l})):r.a.createElement("div",null)}),null),r.a.createElement(O,{setCoords:c,setAddress:i}))},N=window.location.origin;window.socket=l()(N);var x=function(){return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"left"},r.a.createElement(p,null),r.a.createElement(S,null)),r.a.createElement("div",{className:"right"},r.a.createElement(g,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[35,1,2]]]);
//# sourceMappingURL=main.13cd48bf.chunk.js.map